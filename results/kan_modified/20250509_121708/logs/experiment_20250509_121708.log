2025-05-09 12:17:08,840 - INFO - Initialized ModifiedKANExperiment with timestamp 20250509_121708
2025-05-09 12:17:08,840 - INFO - KAN hyperparameters: width=[3, 8, 1], grid=7, k=3
2025-05-09 12:17:08,841 - INFO - Starting KAN experiment
2025-05-09 12:17:08,862 - INFO - Generated data with parameters: m=1.0, c=0.1, k=5.0
2025-05-09 12:17:08,863 - INFO - Data shapes: t=(501,), x=(501,), v=(501,), a=(501,), f=(501,)
2025-05-09 12:17:08,865 - INFO - Data ranges: x=[0.222, 1.000], v=[-0.299, 0.128], a=[-16.128, 16.142], f=[-15.005, 19.955]
2025-05-09 12:17:08,867 - INFO - Using device: cuda
2025-05-09 12:17:08,868 - INFO - Standard deviations: x_std=0.2206, v_std=0.1237, a_std=11.9054, f_std=11.9456
2025-05-09 12:17:08,871 - INFO - Linear regression check: params=[1.  0.1 5. ], R²=1.0000
2025-05-09 12:17:08,872 - INFO - Condition number: 101.04
2025-05-09 12:17:08,873 - INFO - Term contributions: m*a=91.43%, c*v=0.10%, k*x=8.47%
2025-05-09 12:17:08,873 - WARNING - Damping term contributes <10% to force. Damping coefficient estimation may be difficult.
2025-05-09 12:17:08,873 - WARNING - Stiffness term contributes <10% to force. Stiffness estimation may be difficult.
2025-05-09 12:17:08,875 - INFO - Initializing KAN model
2025-05-09 12:17:08,908 - INFO - Training KAN model with LBFGS optimizer
2025-05-09 12:18:00,800 - WARNING - Training history has unexpected format
2025-05-09 12:18:00,802 - WARNING - Unexpected history format: <class 'dict'>
2025-05-09 12:18:01,076 - INFO - Extracted symbolic formula: ([-0.251880462984685*x_1 + 0.0145531140780978*x_2 + 0.936997345350238*x_3 - 0.230724334739021], [x_1, x_2, x_3])
2025-05-09 12:18:01,077 - INFO - Starting improved parameter extraction
2025-05-09 12:18:01,092 - INFO - Symbolic formula: ([-0.251880462984685*x_1 + 0.0145531140780978*x_2 + 0.936997345350238*x_3 - 0.230724334739021], [x_1, x_2, x_3])
2025-05-09 12:18:01,093 - INFO - Successfully extracted parameters from formula: [ 0.93699735  0.01455311 -0.25188046]
2025-05-09 12:18:01,095 - INFO - Linear regression parameters: [1.  0.1 5. ] (R²=1.0000)
2025-05-09 12:18:01,115 - INFO - KAN probing parameters: [  0.94015783   1.4051367  -13.6398129 ]
2025-05-09 12:18:01,136 - INFO - Differentiation parameters: [ 0.93700576  0.01455467 -0.2518811 ]
2025-05-09 12:18:01,137 - INFO - Symbolic parameters look suspicious, using with lower weight
2025-05-09 12:18:01,137 - INFO - Final weighted parameters: [0.96944682 0.47445163 0.01      ] with confidence 0.70
2025-05-09 12:18:01,138 - INFO - Estimated parameters: [0.96944682 0.47445163 0.01      ] with confidence 0.70
2025-05-09 12:18:01,150 - INFO - Parameter errors: [  3.05531832 374.45163199  99.8       ]
2025-05-09 12:18:01,150 - INFO - RMSE: 5.516773
2025-05-09 12:18:09,320 - INFO - Model visualization saved to results/kan_modified/20250509_121708/figures/model/kan_structure_20250509_121708.png
2025-05-09 12:18:11,774 - INFO - Results saved to results/kan_modified/20250509_121708/data/experiment_20250509_121708.json and results/kan_modified/20250509_121708/data/time_series_20250509_121708.npz
2025-05-09 12:18:11,774 - INFO - KAN experiment completed successfully
